@0
MOV -999, RIGHT
MOV UP, DOWN
MOV DOWN, ACC
JLZ MR
JGZ ML
MOV RIGHT, DOWN
MOV DOWN, RIGHT
SWP
JRO -7
MR:MOV LEFT, RIGHT
ADD 1
JRO -8
ML:MOV RIGHT, LEFT
SUB 1
JRO -10

@1
MOV 5, ACC
LOOP:
MOV 0, UP
SUB 1
JNZ LOOP
#MOV 1, RIGHT
MOV DOWN, NIL
MOV 5, ACC
L2:
MOV UP, NIL
SUB 1
JNZ L2

@2
MOV UP, ACC
JEZ END
MOV ACC, RIGHT
SWP
SUB RIGHT
MOV ACC, UP
MOV RIGHT, ACC
SAV
MOV UP, ACC
ADD 1
MOV ACC, UP
MOV 1, RIGHT
JRO -100
END: MOV -1, DOWN
JRO -12

@3
MOV LEFT, ACC
SAV
MOV ACC, LEFT
MOV ACC, LEFT
MOV LEFT, NIL
MOV UP, ACC
MOV ACC, UP
JLZ IDX
MOV ACC, DOWN
MOV ACC, DOWN
SWP
MOV ACC, DOWN
JRO -12
IDX:MOV 0, ACC
#JRO -7

@4
MOV RIGHT, ACC
JLZ END
MOV ACC, RIGHT
END:
MOV ACC, UP

@5
AGAIN:
MOV ANY, ACC
JLZ END
SAV
JRO -3
END:ADD 999
JEZ AGAIN
MOV RIGHT, ACC
JLZ BCUP
SAV
BCUP: SWP
MOV ACC, DOWN
MOV 0, LEFT
MOV 999, RIGHT
MOV 0, RIGHT

@6
S: SUB ANY
JLZ NEWMX
MOV UP, NIL
MOV UP, NIL
JEZ NOMAX
MOV -999, LEFT
JRO 7
NEWMX:MOV ANY, ACC
SAV
JEZ S
MOV ANY, LEFT
JMP S
NOMAX:MOV 0, LEFT
SWP
SAV
